<div class="tasks-root">
    <div class="tasks-header">
      <div class="title-wrap">
        <h2>Mis Tareas</h2>
        <p class="subtitle">Acciones rÃ¡pidas y seguimiento</p>
      </div>
  
      <div class="actions">
        <button class="btn-primary" (click)="abrirCrear()">+ Nueva tarea</button>
      </div>
    </div>
  
    <div class="tasks-grid">
      <div *ngFor="let t of tareas"
           class="task-card"
           [class.completed]="t.estado === 'completada'"
           [class.expanded]="t.expanded"
           (click)="toggleExpand(t)">
  
        <div class="task-left">
          <label class="check" (click)="$event.stopPropagation()">
            <input type="checkbox" 
                   [checked]="t.estado==='completada'" 
                   (change)="toggleEstado(t)" />
            <span></span>
          </label>
  
          <div class="task-info">
            <div class="task-title-row">
              <h4 class="task-title" [title]="t.titulo">{{ t.titulo }}</h4>
              <span class="tag" [ngClass]="getPrioridadColor(t.prioridad)">
                {{ getTextoPrioridad(t.prioridad) }}
              </span>
            </div>
  
            <div class="task-desc">{{ t.descripcion }}</div>
  
            <div class="task-meta">
              <span *ngIf="t.fecha_limite" class="meta-item">
                â° {{ t.fecha_limite | date:'dd/MM/yyyy' }}
              </span>
              <span *ngIf="t.vinculada_meta" class="meta-item">
                ğŸ¯ Meta #{{ t.vinculada_meta }}
              </span>
            </div>
          </div>
        </div>
  
        <div class="task-actions" (click)="$event.stopPropagation()">
          <button class="icon-btn" (click)="abrirEditar(t)"><i class="fa-solid fa-pen"></i></button>
          <button class="icon-btn delete" (click)="eliminar(t)"><i class="fa-solid fa-trash"></i></button>
        </div>
  
        <!-- EXTRA INFO EXPANDIBLE -->
        <div class="extra-info" *ngIf="t.expanded">
          <p><strong>Estado:</strong> {{ t.estado }}</p>
          <p *ngIf="t.vinculada_meta"><strong>Meta vinculada:</strong> {{ t.vinculada_meta }}</p>
          <p *ngIf="t.creado_en"><strong>Creado:</strong> {{ t.creado_en | date:'dd/MM/yyyy' }}</p>
        </div>
  
      </div>
    </div>
  
    <app-crear-tarea
      *ngIf="mostrarModal"
      [tarea]="tareaEnEdicion"
      (cerrar)="cerrarModal()"
      (guardado)="onTareaGuardada($event)">
    </app-crear-tarea>
  </div>
  